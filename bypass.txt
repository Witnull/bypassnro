@echo off
set /p USERNAME="Enter your desired username: "
echo Default password: pass
echo Downloading unattend.xml file...
curl -L -o C:\Windows\Panther\unattend.xml https://raw.githubusercontent.com/Witnull/bypassnro/refs/heads/main/unattend.xml

echo Injecting username...
:: This PowerShell command now ONLY sets the username.
:: It will use the blank password that is already in the downloaded file.
powershell -Command "$xml = [xml](Get-Content C:\Windows\Panther\unattend.xml); $ns = New-Object System.Xml.XmlNamespaceManager($xml.NameTable); $ns.AddNamespace('u', 'urn:schemas-microsoft-com:unattend'); $ns.AddNamespace('wcm', 'http://schemas.microsoft.com/WMIConfig/2002/State'); $account = $xml.SelectSingleNode('//u:LocalAccount', $ns); $account.Name = '%USERNAME%'; $xml.Save('C:\Windows\Panther\unattend.xml')"

echo Starting Sysprep...
%WINDIR%\System32\Sysprep\Sysprep.exe /oobe /unattend:C:\Windows\Panther\unattend.xml /reboot
